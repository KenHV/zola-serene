{% extends "_base.html" %}

{% block page %}blog{% endblock page%}
{% block lang %}{% if section.extra.lang %}{{ section.extra.lang }}{% else %}{{ section.lang }}{% endif %}{% endblock lang %}
{% block title %}{{ section.title | safe }} | {{ config.title | safe}}{% endblock title %}
{% block desc %}
{% set banner_url = get_url(path=config.extra.banner) %}
{% set banner_meta = get_image_metadata(path=config.extra.banner) %}
<meta name="description" content="{{ section.description | safe }}" />
<meta itemprop="name" content="{{ section.title | safe }} | {{ config.title | safe}}">
<meta itemprop="description" content="{{ section.description | safe }}">
<meta itemprop="image" content="{{ banner_url | safe }}">

<meta property="og:site_name" content="{{ config.title | safe }}" />
<meta property="og:title" content="{{ section.title | safe }} | {{ config.title | safe}}" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ current_url }}" />
<meta property="og:description" content="{{ section.description | safe }}" />
<meta property="og:image" content="{{ banner_url | safe }}" />
<meta property="og:image:width" content="{{ banner_meta.width }}" />
<meta property="og:image:height" content="{{ banner_meta.height }}" />

<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content="{{ current_url }}" />
<meta property="twitter:title" content="{{ section.title | safe }} | {{ config.title | safe}}" />
<meta property="twitter:description" content="{{ section.description | safe }}" />
<meta property="twitter:image" content="{{ banner_url | safe }}" />
{% if config.extra.twitter_username %}
  <meta property="twitter:site" content="{{ config.extra.twitter_username | safe}}" />
  <meta property="twitter:creator" content="{{ config.extra.twitter_username | safe}}" />
{% endif %}

<link rel="canonical" href="{{ current_url | safe }}" />
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
{% endblock desc %}

{% block content %}
{% include "_header.html" %}
<div id="wrapper">
  <main class="layout-list">
    {% if config.extra.blog_categorized %}
    {% for category,posts in section.pages | sort(attribute="taxonomies.categories.0") | group_by(attribute="taxonomies.categories.0") %}
    {% set category_name = category %}
    {% if category is matching("^__[0-9]{2}__") %}
      {% set category_name = category | split(pat="") | slice(start=7) | join(sep="") %}
    {% endif %}
    <div class="category">{{ category_name }}</div>
    <div class="post-list categorized">
      {% for post in posts %}
      <a class="post instant {% if post.extra.featured %}featured{% endif %}" href="{{ post.permalink }}">
        <span>{{ post.title }}</span>
        <span class="date">{{ post.date | date}}</span>
      </a>
      {% endfor %}
    </div>
    {% endfor %}
    {% else %}
    <div class="post-list">
      {% for post in section.pages %}
      <a class="post instant {% if post.extra.featured %}featured{% endif %}" href="{{ post.permalink }}">
        <span>{{ post.title }}</span>
        <span class="date">{{ post.date | date}}</span>
      </a>
      {% endfor %}
    </div>
    {% endif %}
  </main>
  {% include "_footer.html" %}
</div>
{% endblock content %}